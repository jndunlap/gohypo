{{/* Evidence Row Template - Table Row Design */}}
<tr class="hover:bg-gray-50 border-b border-gray-200" data-hypothesis-id="{{.ID}}">
  <!-- Status -->
  <td class="px-6 py-4 whitespace-nowrap">
    {{if .Validated}}
      <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium text-gray-700 border border-gray-300">[VALID] Validated</span>
    {{else if .Rejected}}
      <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium text-gray-700 border border-gray-300">[REJECT] Rejected</span>
    {{else}}
      <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium text-gray-700 border border-gray-300">[TEST] Testing</span>
    {{end}}
  </td>

  <!-- Hypothesis -->
  <td class="px-6 py-4">
    <div class="text-sm font-medium text-gray-900">{{if .BusinessHypothesis}}{{if gt (len .BusinessHypothesis) 80}}{{substr .BusinessHypothesis 0 77}}...{{else}}{{.BusinessHypothesis}}{{end}}{{else}}{{.ID}}{{end}}</div>
    <div class="text-xs text-gray-500 mt-1">{{.ID}}</div>
  </td>

  <!-- Effect Size -->
  <td class="px-6 py-4 whitespace-nowrap text-center">
    <div class="text-sm font-semibold text-gray-900">{{if .EffectSize}}{{printf "%.2f" .EffectSize}}{{else}}‚Äî{{end}}</div>
  </td>

  <!-- P-Value -->
  <td class="px-6 py-4 whitespace-nowrap text-center">
    <div class="text-sm font-semibold text-gray-900">
      {{if .PValue}}
        {{if lt .PValue 0.001}}&lt;0.001{{else}}{{printf "%.3f" .PValue}}{{end}}
      {{else}}‚Äî{{end}}
    </div>
    {{if .PermutationPValue}}
    <div class="text-xs text-gray-500 mt-1">
      Perm: {{if lt .PermutationPValue 0.001}}&lt;0.001{{else}}{{printf "%.3f" .PermutationPValue}}{{end}}
    </div>
    {{end}}
  </td>

  <!-- Sample Size -->
  <td class="px-6 py-4 whitespace-nowrap text-center">
    <div class="text-sm font-semibold text-gray-900">
      {{if .SampleSize}}
        {{kfmt .SampleSize}}
      {{else if .ExecutionMetadata}}
        {{if .ExecutionMetadata.sample_size}}
          {{kfmt .ExecutionMetadata.sample_size}}
        {{else}}
          ‚Äî
        {{end}}
      {{else}}
        ‚Äî
      {{end}}
    </div>
    {{if .ValidationConfidence}}
    <div class="text-xs text-gray-500 mt-1">{{printf "%.1f%%" (multiply .ValidationConfidence 100)}}</div>
    {{end}}
  </td>

  <!-- Actions -->
  <td class="px-6 py-4 whitespace-nowrap text-center">
    <button class="text-sm text-blue-600 hover:text-blue-800 font-medium" onclick="toggleEvidenceDrawer('{{.ID}}')">
      Review Science
    </button>
  </td>
</tr>

<!-- Expandable Details Row -->
<tr id="drawer-{{.ID}}" class="bg-white hidden">
  <td colspan="6" class="px-6 py-4" style="width: 100%;">
    <div class="space-y-4" style="width: 100%; max-width: 100%;">
      <!-- Scientific Hypothesis -->
      <div style="width: 100%;">
        <h4 class="text-sm font-semibold text-gray-900 mb-2">Scientific Hypothesis</h4>
        <p class="text-gray-700 text-sm leading-relaxed">{{.ScienceHypothesis}}</p>
      </div>

      <!-- Validation Methods -->
      {{if .ValidationMethods}}
      <div style="width: 100%;">
        <h4 class="text-sm font-semibold text-gray-900 mb-2">Validation Methods</h4>
        {{$methods := .ValidationMethods}}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4" style="width: 100%;">
          {{range $i, $method := $methods}}
            {{if lt $i 3}}
            <div class="bg-white border border-gray-200 p-3">
              <div class="flex items-start justify-between mb-2 gap-3">
                <span class="text-xs font-medium text-gray-500 uppercase tracking-wide">{{.Type}}</span>
                <span class="text-sm font-medium text-gray-900 text-right">{{.MethodName}}</span>
              </div>
              <p class="text-gray-700 text-sm leading-relaxed">{{.ExecutionPlan}}</p>
            </div>
            {{end}}
          {{end}}
        </div>

        <!-- Validation Thresholds -->
        {{if .RefereeGates}}
        <div class="mt-4 pt-4 border-t border-gray-200">
          <h5 class="text-sm font-semibold text-gray-900 mb-3">Validation Thresholds</h5>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <span class="text-xs text-gray-600">Confidence Target:</span>
              <span class="text-sm font-medium text-gray-900 ml-2">{{printf "%.2f" .RefereeGates.ConfidenceTarget}}</span>
            </div>
            <div>
              <span class="text-xs text-gray-600">Stability Threshold:</span>
              <span class="text-sm font-medium text-gray-900 ml-2">{{printf "%.2f" .RefereeGates.StabilityThreshold}}</span>
            </div>
          </div>
        </div>
        {{end}}
      </div>
      {{end}}

      <!-- Validation Results -->
      {{if .ValidationResult}}
      <div style="width: 100%;">
        <h4 class="text-sm font-semibold text-gray-900 mb-2">Permutation Test Results</h4>
        <div class="space-y-2" style="width: 100%;">
          <div class="flex items-center justify-between">
            <span class="text-sm text-gray-600">Status:</span>
            <span class="text-sm font-medium text-gray-900">
              {{.ValidationResult.Status | upper}}
            </span>
          </div>
          {{if .ValidationResult.PValue}}
          <div class="flex items-center justify-between">
            <span class="text-sm text-gray-600">Permutation P-Value:</span>
            <span class="text-sm font-medium">
              {{if lt .ValidationResult.PValue 0.001}}&lt;0.001{{else}}{{printf "%.4f" .ValidationResult.PValue}}{{end}}
            </span>
          </div>
          {{end}}
          {{if .ValidationResult.Confidence}}
          <div class="flex items-center justify-between">
            <span class="text-sm text-gray-600">Confidence:</span>
            <span class="text-sm font-medium">{{printf "%.1f%%" (multiply .ValidationResult.Confidence 100)}}</span>
          </div>
          {{end}}
          {{if .ValidationResult.NumPermutations}}
          <div class="flex items-center justify-between">
            <span class="text-sm text-gray-600">Permutations:</span>
            <span class="text-sm font-medium">{{.ValidationResult.NumPermutations}}</span>
          </div>
          {{end}}
        </div>
      </div>
      {{end}}

      <!-- Falsification Log -->
      {{if .FalsificationLog}}
      <div class="bg-white border-l-2 border-gray-400 p-4">
        <h4 class="text-sm font-semibold text-red-900 mb-2">Rejection Details</h4>
        <div class="space-y-2">
          <p class="text-sm text-red-800"><strong>Reason:</strong> {{.FalsificationLog.Reason}}</p>
          {{if .FalsificationLog.NullDistribution}}
          <div class="mt-3 pt-3 border-t border-red-200">
            <p class="text-xs font-semibold text-red-700 uppercase tracking-wide mb-2">Null Distribution Summary</p>
            <div class="grid grid-cols-2 gap-2 text-xs">
              <div><span class="text-red-600">Mean:</span> {{printf "%.4f" .FalsificationLog.NullDistribution.Mean}}</div>
              <div><span class="text-red-600">Std Dev:</span> {{printf "%.4f" .FalsificationLog.NullDistribution.StdDev}}</div>
              <div><span class="text-red-600">95th %ile:</span> {{printf "%.4f" .FalsificationLog.NullDistribution.Percentile95}}</div>
              <div><span class="text-red-600">99th %ile:</span> {{printf "%.4f" .FalsificationLog.NullDistribution.Percentile99}}</div>
            </div>
          </div>
          {{end}}
        </div>
      </div>
      {{end}}

      <!-- Null Case -->
      {{if .NullCase}}
      <div style="width: 100%;">
        <h4 class="text-sm font-semibold text-gray-900 mb-2">Null Hypothesis</h4>
        <p class="text-gray-600 text-sm italic">{{.NullCase}}</p>
      </div>
      {{end}}
    </div>
  </td>
</tr>

<!-- AUDIT TRAIL SECTION -->
<tr>
  <td colspan="2" style="padding: 0;">
    <div class="evidence-audit" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 4px;">
      <h5 style="margin: 0 0 0.5rem 0; font-size: 0.875rem; font-weight: 600; color: #374151;">Audit Information</h5>

      <div class="audit-meta" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.5rem; margin-bottom: 0.5rem;">
        <div class="audit-entry" style="font-size: 0.75rem;">
          <span class="label" style="font-weight: 500; color: #6b7280;">Generated:</span>
          <time datetime="{{.ComputedAt}}" style="color: #374151;">{{formatTime .ComputedAt}}</time>
        </div>
        <div class="audit-entry" style="font-size: 0.75rem;">
          <span class="label" style="font-weight: 500; color: #6b7280;">Stage:</span>
          <span class="value" style="color: #374151;">{{.StageName}}</span>
        </div>
        <div class="audit-entry" style="font-size: 0.75rem;">
          <span class="label" style="font-weight: 500; color: #6b7280;">Method:</span>
          <span class="value" style="color: #374151;">{{.Method}}</span>
        </div>
        <div class="audit-entry" style="font-size: 0.75rem;">
          <span class="label" style="font-weight: 500; color: #6b7280;">Version:</span>
          <span class="value" style="color: #374151;">{{.SchemaVersion}}</span>
        </div>
      </div>

      <!-- Decision Rationale -->
      <div class="decision-rationale" style="margin-bottom: 0.5rem;">
        <span class="label" style="font-size: 0.75rem; font-weight: 500; color: #6b7280;">Decision Logic:</span>
        <p class="rationale-text" style="font-size: 0.75rem; color: #374151; margin: 0.25rem 0 0 0;">{{.DecisionRationale}}</p>
      </div>

      <!-- Audit Actions -->
      <div class="audit-actions" style="display: flex; gap: 0.5rem;">
        <button class="btn-sm" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; border: 1px solid #d1d5db; border-radius: 3px; background: white; color: #374151; cursor: pointer;" onclick="logEvidenceInteraction('{{.ID}}', 'viewed')">
          ‚úì Mark Reviewed
        </button>
        <button class="btn-sm" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; border: 1px solid #d1d5db; border-radius: 3px; background: white; color: #374151; cursor: pointer;" onclick="flagEvidence('{{.ID}}', 'needs_review')">
          ‚ö†Ô∏è Flag for Review
        </button>
        <button class="btn-sm" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; border: 1px solid #d1d5db; border-radius: 3px; background: white; color: #374151; cursor: pointer;" onclick="addEvidenceNote('{{.ID}}')">
          üìù Add Note
        </button>
      </div>
    </div>
  </td>
</tr>


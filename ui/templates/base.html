<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>{{.Title}}</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10/dist/ext/ws.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/css/research.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>


        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Sleek White Mode Palette - Flat & Clean
                        'vellum': '#FFFFFF',          // Primary Background (pure white)
                        'plotter': '#1A1A1B',         // Primary Text (deep charcoal)
                        'blueprint': '#2563EB',       // Accent Blue (professional)
                        'zinc': '#6B7280',           // Secondary Text (accessible gray)
                        'stamp': '#10B981',          // Success Green (emerald)
                        // Light Mode Surface Colors
                        'surface': '#FFFFFF',         // Pure white for cards
                        'surface-secondary': '#F8F9FA', // Light gray for panels
                        'border': '#E5E7EB',         // Subtle gray borders
                        'border-hover': '#D1D5DB',   // Hover border
                        'success': '#10B981',        // Success/Validated
                        'warning': '#F59E0B',        // Warning
                        'error': '#EF4444',          // Error
                    },
                    fontFamily: {
                        'mono': ['IBM Plex Mono', 'monospace'],
                        'sans': ['Sora', 'sans-serif'],
                    },
                    boxShadow: {
                        'drafting': '4px 4px 0px 0px rgba(26, 26, 27, 1)', // Hard solid shadow
                    },
                    backgroundImage: {
                        'hatch-10': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.1) 2px, rgba(235, 235, 235, 0.1) 4px)",
                        'hatch-20': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.2) 2px, rgba(235, 235, 235, 0.2) 4px)",
                        'hatch-30': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.3) 2px, rgba(235, 235, 235, 0.3) 4px)",
                        'hatch-40': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.4) 2px, rgba(235, 235, 235, 0.4) 4px)",
                        'hatch-50': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.5) 2px, rgba(235, 235, 235, 0.5) 4px)",
                        'hatch-60': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.6) 2px, rgba(235, 235, 235, 0.6) 4px)",
                        'hatch-70': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.7) 2px, rgba(235, 235, 235, 0.7) 4px)",
                        'hatch-80': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.8) 2px, rgba(235, 235, 235, 0.8) 4px)",
                        'hatch-90': "repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(235, 235, 235, 0.9) 2px, rgba(235, 235, 235, 0.9) 4px)",
                    },
                    fontFamily: {
                        'sora': ['Sora', 'system-ui', 'sans-serif'],
                        'plex-mono': ['IBM Plex Mono', 'monospace'],
                    },
                    fontSize: {
                        // Obsidian Typography Hierarchy (High-Contrast, Crushed)
                        'h1': ['2.5rem', { lineHeight: '1', letterSpacing: '-0.05em', fontWeight: '900' }], // 40px, Sora Extra Bold
                        'h2': ['1.75rem', { lineHeight: '1', letterSpacing: '-0.05em', fontWeight: '900' }], // 28px, Sora Extra Bold
                        'h3': ['1.25rem', { lineHeight: '1', letterSpacing: '-0.05em', fontWeight: '900' }], // 20px, Sora Extra Bold
                        'body': ['0.875rem', { lineHeight: '1.4', fontWeight: '400' }], // 14px
                        'label': ['0.75rem', { lineHeight: '1.2', fontWeight: '600', letterSpacing: '0.05em' }], // 12px
                    },
                    spacing: {
                        // 4px Baseline Rhythm System
                        'space-1': '0.25rem', // 4px
                        'space-2': '0.5rem',  // 8px
                        'space-3': '0.75rem', // 12px
                        'space-4': '1rem',    // 16px
                        'space-5': '1.5rem',  // 24px
                        'space-6': '2rem',    // 32px
                        // Legacy spacing for compatibility
                        '18': '4.5rem',
                        '88': '22rem',
                        '128': '32rem',
                    },
                    boxShadow: {
                        'card': '0 1px 3px rgba(0, 0, 0, 0.1)',
                        'card-hover': '0 4px 6px rgba(0, 0, 0, 0.07)',
                        'card-elevated': '0 10px 15px rgba(0, 0, 0, 0.1)',
                        'focus-ring': '0 0 0 3px rgba(59, 130, 246, 0.5)',
                    },
                    borderWidth: {
                        '3': '3px',
                    },
                    /* All animations removed for pure static composition */
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Sleek White Mode CSS Variables */
        :root {
            --color-background: #FFFFFF;
            --color-surface: #FFFFFF;
            --color-surface-secondary: #F8F9FA;
            --color-text-primary: #1A1A1B;
            --color-text-secondary: #6B7280;
            --color-text-accent: #2563EB;
            --color-border: #E5E7EB;
            --color-border-hover: #D1D5DB;
            --color-success: #10B981;
            --color-warning: #F59E0B;
            --color-error: #EF4444;
            --line-height-relaxed: 1.6;
        }

        /* Global Resets for Clean Light Mode */
        * {
            text-rendering: optimizeLegibility;
        }
</style>
</head>
<body class="bg-white text-gray-900 font-sans selection:bg-blue-500 selection:text-white">
    <!-- Flat White Background - No Patterns -->

    <!-- Research Laboratory Layout -->
    <main class="relative min-h-screen">
        {{block "content" .}}{{end}}
    </main>
    <!-- Clean Layout - No Registration Marks Needed -->


    <!-- Research UI Scripts -->
    <script src="/static/js/research.js"></script>
    <script src="/static/js/research_cockpit.js"></script>
    
    <!-- HTMX Configuration -->
    <script>
        // Global HTMX config
        htmx.config.globalViewTransitions = true;
        htmx.config.useTemplateFragments = true;

        // Obsidian Terminal Behaviors
        document.addEventListener('DOMContentLoaded', function() {
            // Redacted Reveal Effect for Loading Data
            const dataElements = document.querySelectorAll('.neo-data');
            dataElements.forEach(el => {
                el.classList.add('redacted-reveal');
            });
        });

        // Loading indicators with Redacted Effect
        document.body.addEventListener('htmx:beforeRequest', function(evt) {
            const btn = evt.target.querySelector('button[type="submit"], button[aria-busy]');
            if (btn) {
                btn.setAttribute('aria-busy', 'true');
                btn.innerHTML = '<span class="redacted-block">██████████</span>';
            }
            // Add loading class to target
            const target = document.querySelector(evt.detail.target);
            if (target) {
                target.classList.add('htmx-loading');
                target.innerHTML = '<div class="redacted-block">█████████████████████████████████████████████</div>';
            }
        });

        document.body.addEventListener('htmx:afterRequest', function(evt) {
            const btn = evt.target.querySelector('button[aria-busy]');
            if (btn) {
                btn.removeAttribute('aria-busy');
            }
            // Remove loading class from target
            const target = document.querySelector(evt.detail.target);
            if (target) {
                target.classList.remove('htmx-loading');
            }

            // Trigger Impact Shake on successful validation
            if (evt.detail.successful) {
                triggerImpactShake();
            }
        });

        // Error handling
        document.body.addEventListener('htmx:responseError', function(evt) {
            console.error('HTMX Error:', evt.detail);
            // Could show toast notification here
        });

        // Dynamic Cursor Crosshair Expansion
        document.addEventListener('mousemove', function(e) {
            const cursorCrosshair = document.querySelector('.cursor-crosshair');
            if (cursorCrosshair) {
                const rect = cursorCrosshair.getBoundingClientRect();
                const distance = Math.sqrt(
                    Math.pow(e.clientX - (rect.left + rect.width / 2), 2) +
                    Math.pow(e.clientY - (rect.top + rect.height / 2), 2)
                );
                const maxDistance = 200;
                const scale = Math.max(0.5, Math.min(1.5, 1 - (distance / maxDistance)));
                document.documentElement.style.setProperty('--cursor-scale', scale);
            }
        });

        // Removed terminal-specific effects for clean light mode
    </script>

    <!-- Global Components -->
    {{template "scientists-drawer" .}}
    {{template "right-sidebar" .}}
</body>
</html>
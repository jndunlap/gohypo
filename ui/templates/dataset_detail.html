{{template "base.html" .}}

{{define "content"}}
<div class="px-4 py-6 sm:px-0">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Dataset Analysis</h1>
        <p class="mt-2 text-gray-600">Dataset ID: <code class="bg-gray-100 px-2 py-1 rounded text-sm">{{.DatasetID}}</code></p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Left: Readiness Gates -->
        <div class="lg:col-span-1">
            <div class="bg-white shadow rounded-lg p-6">
                <h2 class="text-lg font-medium text-gray-900 mb-4">
                    <i class="fas fa-gavel mr-2 text-blue-600"></i>
                    Readiness Gates
                </h2>

                <div class="space-y-3" id="readiness-gates">
                    <div class="readiness-gate flex items-center p-3 border rounded-md">
                        <i class="fas fa-check-circle text-green-500 mr-3"></i>
                        <div>
                            <div class="text-sm font-medium text-gray-900">Parse OK</div>
                            <div class="text-xs text-gray-500">CSV file parsed successfully</div>
                        </div>
                    </div>

                    <div class="readiness-gate flex items-center p-3 border rounded-md">
                        <i class="fas fa-check-circle text-green-500 mr-3"></i>
                        <div>
                            <div class="text-sm font-medium text-gray-900">Entity Key</div>
                            <div class="text-xs text-gray-500">Entity identifier column found</div>
                        </div>
                    </div>

                    <div class="readiness-gate flex items-center p-3 border rounded-md">
                        <i class="fas fa-check-circle text-green-500 mr-3"></i>
                        <div>
                            <div class="text-sm font-medium text-gray-900">Minimum Rows</div>
                            <div class="text-xs text-gray-500">12,847 rows (threshold: 1,000)</div>
                        </div>
                    </div>

                    <div class="readiness-gate flex items-center p-3 border rounded-md">
                        <i class="fas fa-exclamation-triangle text-yellow-500 mr-3"></i>
                        <div>
                            <div class="text-sm font-medium text-gray-900">Variable Eligibility</div>
                            <div class="text-xs text-gray-500">Some columns may not be testable</div>
                        </div>
                    </div>
                </div>

                <div class="mt-6 space-y-3">
                    <button
                        hx-post="/api/datasets/{{.DatasetID}}/profile"
                        hx-target="#profile-results"
                        hx-swap="innerHTML"
                        class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                        <i class="fas fa-search mr-2"></i>
                        Run Data Profiling
                    </button>

                    <button
                        hx-post="/api/datasets/{{.DatasetID}}/sweep"
                        hx-target="#sweep-results"
                        hx-swap="innerHTML"
                        class="w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                        <i class="fas fa-chart-line mr-2"></i>
                        Run Statistical Sweep
                    </button>
                </div>
            </div>
        </div>

        <!-- Center: Profile Results -->
        <div class="lg:col-span-2">
            <div class="space-y-6">
                <!-- Profile Results -->
                <div class="bg-white shadow rounded-lg p-6">
                    <h2 class="text-lg font-medium text-gray-900 mb-4">
                        <i class="fas fa-chart-bar mr-2 text-green-600"></i>
                        Data Profile
                    </h2>

                    <div id="profile-results" class="text-gray-500">
                        <p>Click "Run Data Profiling" to analyze your dataset structure and quality.</p>
                    </div>
                </div>

                <!-- Sweep Results -->
                <div class="bg-white shadow rounded-lg p-6">
                    <h2 class="text-lg font-medium text-gray-900 mb-4">
                        <i class="fas fa-network-wired mr-2 text-purple-600"></i>
                        Statistical Relationships
                    </h2>

                    <div id="sweep-results" class="text-gray-500">
                        <p>Click "Run Statistical Sweep" to discover relationships between variables.</p>
                    </div>
                </div>

                <!-- Next Steps -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                    <h3 class="text-lg font-medium text-blue-900 mb-2">
                        <i class="fas fa-arrow-right mr-2"></i>
                        Next Steps
                    </h3>
                    <div class="text-blue-800 space-y-2">
                        <p>• Complete data profiling to understand variable characteristics</p>
                        <p>• Run statistical sweep to discover relationships</p>
                        <p>• <a href="/relationships" class="underline hover:text-blue-600">View discovered relationships</a></p>
                        <p>• <a href="/hypotheses" class="underline hover:text-blue-600">Generate hypotheses</a> from significant relationships</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- HTMX Partials -->
{{template "profile_results.html" .}}
{{template "sweep_results.html" .}}
{{end}}
